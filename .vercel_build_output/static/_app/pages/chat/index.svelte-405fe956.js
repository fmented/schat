import{S as W,i as J,s as K,e as d,w as M,k as E,c as $,a as y,x as R,m as L,d as m,b as _,g as b,y as U,J as v,q as w,o as C,B as j,t as A,h as D,n as F,p as G,U as H,R as N,v as O,K as P}from"../../chunks/vendor-1841b722.js";import{S as Q}from"../../chunks/bridge-0fce5198.js";import{L as T}from"../../chunks/ListItem-6704c923.js";import{s as X,i as Y,g as I}from"../../chunks/helper-7d864c4a.js";import"../../chunks/index-a1babe66.js";function q(l,e,s){const r=l.slice();return r[4]=e[s],r}function V(l){let e,s,r,u,c;return s=new T({props:{img:l[4].pic,text:{strong:l[4].with,small:l[4].content}}}),{c(){e=d("a"),M(s.$$.fragment),r=E(),this.h()},l(a){e=$(a,"A",{href:!0,class:!0});var f=y(e);R(s.$$.fragment,f),r=L(f),f.forEach(m),this.h()},h(){_(e,"href",u="/chat/"+(l[4].from===l[1].user?l[4].to:l[4].from)+"/"),_(e,"class","svelte-oyfifv")},m(a,f){b(a,e,f),U(s,e,null),v(e,r),c=!0},p(a,f){const h={};f&1&&(h.img=a[4].pic),f&1&&(h.text={strong:a[4].with,small:a[4].content}),s.$set(h),(!c||f&3&&u!==(u="/chat/"+(a[4].from===a[1].user?a[4].to:a[4].from)+"/"))&&_(e,"href",u)},i(a){c||(w(s.$$.fragment,a),c=!0)},o(a){C(s.$$.fragment,a),c=!1},d(a){a&&m(e),j(s)}}}function Z(l){let e,s,r,u,c,a,f,h,S,p=l[0],n=[];for(let t=0;t<p.length;t+=1)n[t]=V(q(l,p,t));const z=t=>C(n[t],1,1,()=>{n[t]=null});return{c(){e=d("div"),s=d("a"),r=A("Settings"),u=E(),c=d("a"),a=A("Search"),f=E(),h=d("div");for(let t=0;t<n.length;t+=1)n[t].c();this.h()},l(t){e=$(t,"DIV",{class:!0});var i=y(e);s=$(i,"A",{href:!0,class:!0});var o=y(s);r=D(o,"Settings"),o.forEach(m),u=L(i),c=$(i,"A",{href:!0,class:!0});var g=y(c);a=D(g,"Search"),g.forEach(m),i.forEach(m),f=L(t),h=$(t,"DIV",{class:!0});var B=y(h);for(let k=0;k<n.length;k+=1)n[k].l(B);B.forEach(m),this.h()},h(){_(s,"href","/settings"),_(s,"class","svelte-oyfifv"),_(c,"href","/search"),_(c,"class","svelte-oyfifv"),_(e,"class","header svelte-oyfifv"),_(h,"class","svelte-oyfifv")},m(t,i){b(t,e,i),v(e,s),v(s,r),v(e,u),v(e,c),v(c,a),b(t,f,i),b(t,h,i);for(let o=0;o<n.length;o+=1)n[o].m(h,null);S=!0},p(t,[i]){if(i&3){p=t[0];let o;for(o=0;o<p.length;o+=1){const g=q(t,p,o);n[o]?(n[o].p(g,i),w(n[o],1)):(n[o]=V(g),n[o].c(),w(n[o],1),n[o].m(h,null))}for(F(),o=p.length;o<n.length;o+=1)z(o);G()}},i(t){if(!S){for(let i=0;i<p.length;i+=1)w(n[i]);S=!0}},o(t){n=n.filter(Boolean);for(let i=0;i<n.length;i+=1)C(n[i]);S=!1},d(t){t&&m(e),t&&m(f),t&&m(h),H(n,t)}}}function x(l,e,s){let r;N(l,X,f=>s(1,r=f));let u,c=[],a;return O(async()=>{u=Y(r.user),s(0,c=await I(u)),a=new Q(navigator.serviceWorker),await a.emit("open",r.user),a.on("update",async f=>{!u||s(0,c=await I(u))})}),[c,r]}class ee extends W{constructor(e){super();J(this,e,x,Z,K,{})}}function te(l){let e,s;return e=new ee({}),{c(){M(e.$$.fragment)},l(r){R(e.$$.fragment,r)},m(r,u){U(e,r,u),s=!0},p:P,i(r){s||(w(e.$$.fragment,r),s=!0)},o(r){C(e.$$.fragment,r),s=!1},d(r){j(e,r)}}}const le=async({session:l})=>l.user?{}:{status:301,redirect:"/"};class ie extends W{constructor(e){super();J(this,e,null,te,K,{})}}export{ie as default,le as load};
